\documentclass[12pt]{article}

\usepackage[onlytext]{MinionPro}
\usepackage{microtype}

\usepackage{physics}

\setlength{\parindent}{0in}                                                     % No indentation for every paragraph

\usepackage[left=3cm, right=3cm]{geometry}		                                % Margins left and right
\usepackage{hyperref}                                                           % Clickable table of contents in PDFs
\usepackage{datetime}                                                           % Currenttime


\title{The Roothaan-Hall equations}
\author{Laurent Lemmens}
\date{\today \hspace{6pt} \currenttime}

\begin{document}

\maketitle

\begin{center}
\line(1,0){250}
\end{center}

\tableofcontents
\newpage

% % % MAIN TEXT % % %

\section{The implementation procedure for RHF}
    In Szabo \cite{szabo}, we can find a recipe to implement the Roothaan-Hall equations. However, we can omit the calculation of the matrix
    \begin{equation}
        \vb{X} = \vb{S}^{-1/2}
    \end{equation}
    and subsequent transformations and back-transformations by recognizing that the Roothaan equation
    \begin{equation} \label{eq:roothaan}
        \vb{F} \vb{C} = \vb{S} \vb{C} \boldsymbol{\varepsilon}
    \end{equation}
    can be classified as a generalized eigenvalue problem. In the Roothaan equation, $\vb{F}$ is the Fock matrix (cfr. equation (\ref{eq:fock_matrix})), $\vb{C}$ is the $K \times K$-coefficient matrix in which the first MO is described by the first column in terms of the basis functions, and $\vb{S}$ is the overlap integral matrix. \\

    In RHF, we can calculate the elements of the density matrix $\vb{P}$ as
    \begin{equation}
        P_{\mu \nu} = 2 \sum_a^{N/2} C_{\mu a} C^*_{\nu a} \thinspace .
    \end{equation}
    However, by introducing the $K \times K$ occupancy matrix
    \begin{equation}
        \vb{O} = \mqty(\dmat{2, \ddots, 2, 0, \ddots, 0}) \thinspace ,
    \end{equation}
    we can calculate the density matrix as
    \begin{equation}
        \vb{P} = \vb{C} \vb{O} \vb{C}^\dagger \thinspace .
    \end{equation}

    We can then implement the Roothaan-Hall SCF cycle as follows:
    \begin{enumerate}
        \item Specify a molecule (a set of nucleic coordinates, their charge and the number of electrons) and a basis set.

        \item Calculate the overlap integral matrix $\vb{S}$, the kinetic integral matrix $\vb{T}$, the nuclear attraction integral matrix $\vb{V}$, and the two-electron integrals $(\mu \nu|\lambda \sigma)$, which are defined in chemist's notation
        \begin{equation}
            (\mu \nu|\lambda \sigma) = \int \int \dd{\vb{r}_1} \dd{\vb{r}_2} \frac{\phi_\mu^*(\vb{r}_1) \phi_\nu(\vb{r}_1) \phi_\lambda^*(\vb{r}_2) \phi_\sigma(\vb{r}_2)}{|\vb{r}_1 - \vb{r}_2|} \thinspace ,
        \end{equation}
        and calculate the core Hamiltonian matrix $\vb{H}^\text{core}$:
        \begin{equation}
            \vb{H} = \vb{T} + \vb{V} \thinspace .
        \end{equation}

        \item Obtain a guess for the density matrix $\vb{P}$. This can be done by solving the generalized eigenvalue equation
        \begin{equation}
            \vb{H}^\text{core} \vb{C} = \vb{S} \vb{C} \vb{h}^\text{core}
        \end{equation}
        for the coefficient matrix $\vb{C}$ and calculating the density matrix $\vb{P}$ from it.

        \item \label{item:scf:g_matrix}  Calculate the matrix $\vb{G}$ as
        \begin{equation}
            G_{\mu \nu} = \sum_{\lambda \sigma} P_{\lambda \sigma} \qty[ (\mu \nu|\sigma \lambda) - \frac{1}{2} (\mu \lambda|\sigma \nu)] \thinspace .
        \end{equation}

        \item Calculate the Fock matrix $\vb{F}$ as
        \begin{equation} \label{eq:fock_matrix}
            \vb{F} = \vb{H}^\text{core} + \vb{G} \thinspace .
        \end{equation}

        \item Solve the Roothaan equation (cfr. equation (\ref{eq:roothaan})) for the coefficient matrix $\vb{C}$, and calculate an improved density matrix $\vb{P}$.

        \item Check for convergence on the density matrix $\vb{P}$, and if no convergence is yet achieved, return to step \ref{item:scf:g_matrix}. We can check for converge by requiring that the Frobenius norm is smaller than a certain threshold $\varepsilon$:
        \begin{equation}
            ||\vb{P}_i - \vb{P}_{i-1}||_\text{F} \leq \varepsilon .
        \end{equation}

        \item If convergence is achieved, output the results. The energy can be calculated by
        \begin{equation}
            E = \frac{1}{2} \sum_{\mu \nu} P_{\nu \mu} (H^\text{core}_{\mu \nu} + F_{\mu \nu}) \thinspace .
        \end{equation}
    \end{enumerate}




% % % REFERENCES % % %

\bibliographystyle{unsrt}                                                       % Bibliography in chronological order
\bibliography{/Users/laurentlemmens/Documents/Archief/Bibliotheek/research_bib}

\end{document}
